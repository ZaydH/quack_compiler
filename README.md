# Quack Language Compiler

[![Documentation Status](https://readthedocs.org/projects/quack-compiler/badge/?version=latest)](https://quack-compiler.readthedocs.io/en/latest/?badge=latest)
[![docs](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)

Developed by: Zayd Hammoudeh <[zayd.hammoudeh@gmail.com](mailto:zayd.hammoudeh@gmail.com)>

## Quack Language

Developed by [Michal Young](http://ix.cs.uoregon.edu/~michal/) at the University of Oregon.  A complete specification of the language is available [here](quack-language-specification.pdf).  The language is inspired by [Alexander Aiken](http://theory.stanford.edu/~aiken/)'s [COOL](https://en.wikipedia.org/wiki/Cool_(programming_language)) language.  Features of the language include:

* User defined and base classes
* Functions \& methods
* Basic looping
* Inheritance
* Type inference
* Operator syntactic sugaring
* Short-circuit evaluation

## Compiler Stages

The compiler follows the standard five stages:

1. Lexing
2. Parsing
3. AST Construction
4. Type inference
5. Code generation

Note that the code generated by the compiler is standard~C.  The generated code does *not* free memory so care should be shown.

## Compiler Dependencies

The following must be installed on your system to build the quack compiler.

* C++ 14
* [re-FLEX](https://github.com/Genivia/RE-flex) -- Fast [flex](https://ftp.gnu.org/old-gnu/Manuals/flex-2.5.4/html_node/flex_19.html) style lexical analyzer
* [Bison](https://www.gnu.org/software/bison/)

## Building & Running the Compiler

A build script is included for your convenience.  Simply run `src/build.sh`.  This will create a binary file `src/bin/code_generator`. 

To run the program, simply call:

`src/bin/code_generator <quack_program_filename.qk>`

If an error is encountered, the compiler quits immediately.  Otherwise, the program generates an output `.c` file.  This file is in the same location as the specified `<quack_program_filename.qk>` passed to the script. The filename is also the same.  The only modification is that the file extension is changed to `.c`.

To compile the generated output, you call:

`gcc <quack_program_filename.c> builtins.c`

Observe that `builtins.c` is a dependency of the generated code.  `builtins.c` and `builtins.h` are included in the `src` directory.  Calling `gcc` as above should yield a compiled binary named `a.out` (or whatever name you specify with the `-o` option).

## Testbench

A suite of testcases showing example `quack` programs is included in the folder `test`.  The expected output for each file is in the folder: `test/expected`. Automated running of the test bench is supported by the file `quack_compiler_testbench.sh`.  A list of the test bench files and their expected return state is in the file `test/all_tests.csv`.
